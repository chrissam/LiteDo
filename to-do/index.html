<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiteDo ‚Äî Light, Fast, Yours</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="brand-row">
                    <svg class="app-logo" viewBox="0 0 64 64" aria-hidden="true">
                        <defs>
                            <linearGradient id="mintGrad" x1="0" x2="1" y1="0" y2="1">
                                <stop offset="0%" stop-color="#a8e6a3"/>
                                <stop offset="100%" stop-color="#21a0aa"/>
                            </linearGradient>
                        </defs>
                        <circle cx="32" cy="32" r="28" fill="url(#mintGrad)" opacity="0.95"/>
                        <!-- Feather/quill tilted for clarity -->
                        <g transform="rotate(-20 32 32)">
                            <!-- Feather body -->
                            <path d="M36 10 C44 14 50 22 52 30 C54 38 50 46 44 52 C38 58 30 60 24 56 C18 52 16 44 18 36 C20 28 26 18 36 10 Z"
                                  fill="#f7fffb" stroke="#0e3a3f" stroke-width="2"/>
                            <!-- Shaft (rachis) -->
                            <path d="M24 56 L46 16" stroke="#0e3a3f" stroke-width="2.6" stroke-linecap="round"/>
                            <!-- Barbs -->
                            <path d="M28 48 L35 43" stroke="#a2e7da" stroke-width="2" stroke-linecap="round"/>
                            <path d="M30 44 L38 38" stroke="#a2e7da" stroke-width="2" stroke-linecap="round"/>
                            <path d="M32 40 L40 34" stroke="#a2e7da" stroke-width="2" stroke-linecap="round"/>
                            <path d="M34 36 L42 30" stroke="#a2e7da" stroke-width="2" stroke-linecap="round"/>
                            <path d="M36 32 L44 26" stroke="#a2e7da" stroke-width="2" stroke-linecap="round"/>
                        </g>
                        <!-- Ink check to suggest to‚Äëdo -->
                        <path d="M18 46 l7 7 l14 -14" fill="none" stroke="#0e3a3f" stroke-width="3.2" stroke-linecap="round" stroke-linejoin="round" opacity="0.85"/>
                    </svg>
                    <div>
                        <h1 class="app-title">LiteDo</h1>
                        <p class="app-tagline">Lightweight. Fast. Yours.</p>
                    </div>
                </div>
            </div>

            <!-- Search Box -->
            <div class="search-container">
                <div class="search-input-wrapper" style="display:flex; gap:8px; align-items:center;">
                    <input type="text" id="searchInput" class="search-input" placeholder="Search (e.g., tag:work completed:true before:2025-01-01)">
                    <span class="search-icon">üîç</span>
                    <button class="btn btn--secondary btn--sm" id="searchHelpBtn" title="Search tips">?</button>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="navigation">
                <button class="nav-item active" data-filter="all">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-text">All</span>
                    <span class="task-count" id="allCount">0</span>
                </button>
                <button class="nav-item" data-filter="today">
                    <span class="nav-icon">üìÖ</span>
                    <span class="nav-text">Today</span>
                    <span class="task-count" id="todayCount">0</span>
                </button>
                <button class="nav-item" data-filter="upcoming">
                    <span class="nav-icon">‚è∞</span>
                    <span class="nav-text">Upcoming</span>
                    <span class="task-count" id="upcomingCount">0</span>
                </button>
                <button class="nav-item" data-filter="overdue">
                    <span class="nav-icon">‚ö†Ô∏è</span>
                    <span class="nav-text">Overdue</span>
                    <span class="task-count" id="overdueCount">0</span>
                </button>
                <button class="nav-item" data-filter="completed">
                    <span class="nav-icon">‚úÖ</span>
                    <span class="nav-text">Completed</span>
                    <span class="task-count" id="completedCount">0</span>
                </button>
            </nav>

            <!-- Show Completed Checkbox -->
            <div class="filter-option">
                <label class="checkbox-label">
                    <input type="checkbox" id="showCompleted" checked>
                    <span class="checkbox-custom"></span>
                    Show completed
                </label>
                <label class="checkbox-label" style="margin-top:8px;">
                    <input type="checkbox" id="showTagsPanel">
                    <span class="checkbox-custom"></span>
                    Show tags panel
                </label>
            </div>

            <!-- Sort Dropdown -->
            <div class="sort-container">
                <label class="form-label">Sort by</label>
                <select id="sortBy" class="form-control">
                    <option value="createdDate">Created Date</option>
                    <option value="priority">Priority</option>
                    <option value="dueDate">Due Date</option>
                </select>
            </div>

            <!-- Tags Section -->
            <div class="tags-section" id="tagsSection">
                <h3 class="section-title">Tags</h3>
                <div class="form-group" style="margin-bottom: 8px;">
                    <input type="text" id="tagSearchInput" class="form-control" placeholder="Filter tags..." />
                </div>
                <div class="tags-container" id="tagsContainer">
                    <!-- Tags will be dynamically populated -->
                </div>
            </div>

            <!-- Bottom Actions -->
            <div class="sidebar-footer">
                <div id="fileStatus" class="selected-count" style="margin: 0 0 8px 0;">No file open</div>
                <button class="btn btn--outline btn--full-width" id="newFileBtn">New file‚Ä¶</button>
                <button class="btn btn--outline btn--full-width" id="openFileBtn">Open file‚Ä¶</button>
                <button class="btn btn--outline btn--full-width" id="saveFileBtn">Save</button>
                <button class="btn btn--outline btn--full-width" id="saveAsFileBtn">Save as‚Ä¶</button>
                <button class="btn btn--outline btn--full-width" id="importBtn">Import JSON‚Ä¶</button>
                <input type="file" id="importFileInput" accept="application/json" style="display:none;" />
                <button class="btn btn--outline btn--full-width" id="exportBtn">Export JSON</button>
                <button class="btn btn--outline btn--full-width" id="exportMdBtn">Export Markdown</button>
                <label class="checkbox-label" style="margin-top: 8px;">
                    <input type="checkbox" id="autoSaveToggle">
                    <span class="checkbox-custom"></span>
                    Auto-save to file
                </label>
                <label class="checkbox-label" style="margin-top: 8px;">
                    <input type="checkbox" id="autoReloadToggle">
                    <span class="checkbox-custom"></span>
                    Auto-reload from file
                </label>
                <label class="checkbox-label" style="margin-top: 8px;">
                    <input type="checkbox" id="reopenOnStartupToggle">
                    <span class="checkbox-custom"></span>
                    Reopen last file on startup
                </label>
                <div class="form-group" style="margin-top: 8px;">
                    <label class="form-label" for="autoReloadInterval">Auto-reload every (seconds)</label>
                    <input type="number" id="autoReloadInterval" class="form-control" min="2" step="1" value="5" />
                </div>
                <div class="form-group" style="margin-top: 8px;">
                    <label class="form-label" for="themeSelect">Theme</label>
                    <select id="themeSelect" class="form-control">
                        <option value="auto">Auto</option>
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                    </select>
                </div>
                <button class="btn btn--outline btn--full-width" id="resetBtn">Reset</button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <h1 class="page-title">Tasks</h1>
                    <div class="stats">
                        <span id="taskStats">0 tasks, 0% complete</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="btn btn--secondary" id="clearSearchBtn" style="display: none;">Clear search</button>
                    <button class="btn btn--secondary" id="analyticsBtn">Show analytics</button>
                </div>
            </header>

            <!-- Add Task Form -->
            <div class="add-task-section" id="addTaskSection">
                <div class="add-task-header">
                    <h3 class="section-title" style="margin:0;">New Task</h3>
                    <button type="button" id="toggleComposerBtn" class="btn btn--secondary btn--sm" aria-expanded="true" aria-label="Hide composer">‚àí</button>
                </div>
                <form id="addTaskForm" class="add-task-form">
                    <div class="form-row">
                        <div class="form-group flex-1">
                            <input type="text" id="taskTitle" class="form-control" placeholder="Task title..." required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group flex-1">
                            <textarea id="taskDescription" class="form-control" placeholder="Add notes..." rows="2"></textarea>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <button type="button" id="addSubtaskBtn" class="btn btn--outline btn--sm">+ Add subtask</button>
                        </div>
                        <div class="form-group">
                            <input type="date" id="taskDueDate" class="form-control">
                        </div>
                        <div class="form-group">
                            <select id="taskPriority" class="form-control">
                                <option value="Low">Low Priority</option>
                                <option value="Med">Med Priority</option>
                                <option value="High">High Priority</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" id="taskTags" class="form-control" placeholder="Tags (comma separated)">
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn--primary">Add Task</button>
                        </div>
                    </div>

                    <div id="subtasksContainer" class="subtasks-container" style="display: none;">
                        <!-- Subtasks will be added here dynamically -->
                    </div>
                </form>
            </div>

            <!-- Bulk Actions -->
            <div class="bulk-actions">
                <div class="bulk-left">
                    <button class="btn btn--outline btn--sm" id="markDoneBtn">Mark done</button>
                    <button class="btn btn--outline btn--sm" id="deleteSelectedBtn">Delete</button>
                    <span class="selected-count" id="selectedCount">Selected 0</span>
                </div>
                <div class="bulk-right">
                    <label class="checkbox-label">
                        <input type="checkbox" id="selectAllCheckbox">
                        <span class="checkbox-custom"></span>
                        Select all
                    </label>
                </div>
            </div>

            <!-- Task List -->
            <div class="task-list" id="taskList">
                <!-- Tasks will be dynamically populated -->
            </div>

            <!-- Analytics Modal -->
            <div id="analyticsModal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Analytics</h2>
                        <button class="modal-close" id="closeAnalyticsBtn">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h3>Task Completion</h3>
                                <div class="stat-number" id="completionRate">0%</div>
                            </div>
                            <div class="analytics-card">
                                <h3>Overdue Tasks</h3>
                                <div class="stat-number" id="overdueTasksCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h3>Tasks Due Today</h3>
                                <div class="stat-number" id="todayTasksCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h3>Total Tasks</h3>
                                <div class="stat-number" id="totalTasksCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h3>Completed (7d)</h3>
                                <div class="stat-number" id="completed7d">0</div>
                            </div>
                            <div class="analytics-card">
                                <h3>Completed (30d)</h3>
                                <div class="stat-number" id="completed30d">0</div>
                            </div>
                        </div>
                        <div style="margin-top: 16px;">
                            <h3 class="section-title">Top Tags</h3>
                            <div id="topTags" class="tags-container"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Help Modal -->
            <div id="searchHelpModal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Search help</h2>
                        <button class="modal-close" id="closeSearchHelpBtn">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="card__body">
                            <p>Use operators in the search box. Keys are case-insensitive.</p>
                            <ul>
                                <li><code>tag:work</code> ‚Äî filter by tag</li>
                                <li><code>priority:High</code></li>
                                <li><code>completed:true</code> | <code>false</code></li>
                                <li><code>is:today</code> | <code>upcoming</code> | <code>overdue</code> | <code>completed</code></li>
                                <li><code>due:YYYY-MM-DD</code>, <code>before:YYYY-MM-DD</code>, <code>after:YYYY-MM-DD</code></li>
                                <li><code>created:YYYY-MM-DD</code> | <code>today</code> | <code>yesterday</code></li>
                                <li><code>createdBefore:YYYY-MM-DD</code>, <code>createdAfter:YYYY-MM-DD</code></li>
                                <li><code>text:"exact phrase"</code> ‚Äî match in title/description</li>
                            </ul>
                            <p>Free text terms also match title, description, and tags.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Task Modal -->
            <div id="editTaskModal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Edit Task</h2>
                        <button class="modal-close" id="closeEditBtn">√ó</button>
                    </div>
                    <div class="modal-body">
                        <form id="editTaskForm">
                            <input type="hidden" id="editTaskId">
                            <div class="form-group">
                                <label class="form-label">Task Title</label>
                                <input type="text" id="editTaskTitle" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea id="editTaskDescription" class="form-control" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Due Date</label>
                                <input type="date" id="editTaskDueDate" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <select id="editTaskPriority" class="form-control">
                                    <option value="Low">Low Priority</option>
                                    <option value="Med">Med Priority</option>
                                    <option value="High">High Priority</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Tags</label>
                                <input type="text" id="editTaskTags" class="form-control" placeholder="Tags (comma separated)">
                            </div>
                             <div class="form-group">
                                 <label class="form-label">Subtasks</label>
                                 <div style="margin-bottom: 8px;">
                                     <button type="button" id="editAddSubtaskBtn" class="btn btn--outline btn--sm">+ Add subtask</button>
                                 </div>
                                 <div id="editSubtasksContainer" class="subtasks-container" style="display: none;"></div>
                             </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn--outline" id="cancelEditBtn">Cancel</button>
                                <button type="submit" class="btn btn--primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>